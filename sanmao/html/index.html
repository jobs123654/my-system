<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>百度地图</title>
    <style type="text/css">
        body{
            margin: 0;
            overflow: hidden;
            background: #fff;
        }
        #map{


            border:1px solid #3473b7;
        }
    </style>
    <script src="../js/jquery-1.11.1.js"></script>
    <link href='../css/bootstrap.min.css' rel='stylesheet' />
    <link href='../css/bootstrap-responsive.min.css' rel='stylesheet' />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=1.5&ak=95a21d20cfe4df8d03f267282e62d8ae"></script>
    <script src = '../libs/SuperMap.Include.js'></script>
    <script type="text/javascript" src="../libs/iConnectorBaidu.js"></script>
</head>
<body onLoad = "init()">
<div class="container-fluid">
    <div class="row" style="position: relative">
        <div class="btn-group" style="position: fixed; top: 10%;left: 10%;z-index: 99">
            <button class="btn btn-success" id="query">查询</button>
            <button class="btn btn-success">查询</button>
            <button class="btn btn-success">查询</button>
            <button class="btn btn-success" onclick="clearFeatures()">清除</button>
        </div>
        <div id="map"  style="position: absolute; width: 100%;border: 1px solid black;z-index: 0;">

        </div>
    </div>
</div>

<script type="text/javascript">
    //------------------------------------------------------------------------------
$('#query').click(function () {
  getFeaturesByIDs();
});
    //----------------------------------------初始化百度地图-----------------------------------------------------------------
    // D:\SuperMapiServer8C\iClient\forJavaScript\examples\images
    var tileLayer,layer,vector, map ,style = {
        strokeColor: "#304DBE",
        strokeWidth: 1,
        pointerEvents: "visiblePainted",
        fillColor: "#304DBE",
        pointRadius: 15,
        externalGraphic: "../img/markerflag.png",

    };

    var host = document.location.toString().match(/file:\/\//) ? "http://localhost:8090" : 'http://' + document.location.host;
    // url = host + "/iserver/services/map-china400/rest/maps/China";
    url = "http://localhost:8090/iserver/services/map-yang/rest/maps/map";//地图服务
    url1="http://localhost:8090/iserver/services/data-yang/rest/data";//数据服务
                // url2=host+"/iserver/services/data-world/rest/data";

    function init() {

        document.getElementById('map').style.height=window.innerHeight+"px";
        //添加比例尺控件
        // var map0=map=new BMap.Map('map');
        // map0.centerAndZoom(new BMap.Point( 108.21 , 40.86), 3);


        // map0.addControl(new BMap.ScaleControl());
        // //添加导航控件
        // map0.addControl(new BMap.NavigationControl());
        //
        // //设置鼠标滑轮放大缩小地图可用
        // map0.enableScrollWheelZoom(true);
        //初始化定位


        map = new SuperMap.Map("map",{controls:[
                new SuperMap.Control.Zoom() ,
                new SuperMap.Control.Navigation() ,
                new SuperMap.Control.LayerSwitcher()
            ]});

        // layer= new SuperMap.Layer.TiledDynamicRESTLayer("World", url, null,{maxResolution:"auto"});

        layer = new SuperMap.Layer.TiledDynamicRESTLayer("World", url, {transparent: true, cacheEnabled: true},{maxResolution:"auto"});

        layer.events.on({"layerInitialized":addLayer});




        vector=new SuperMap.Layer.Vector("vector");

        // map.addLayers([layer,vector]);
        //



    }
    function addLayer(){

        map.addLayers([layer,vector]);
//显示地图范围
        map.setCenter(new SuperMap.LonLat( 118.21 , 39.86 ), 0);
    }




    //----------------------------------------id查询
    function getFeaturesByIDs() {
        // vector.removeAllFeatures();

        var getFeaturesByIDsParameters, getFeaturesByIDsService;
             getFeaturesByIDsParameters = new SuperMap.REST.GetFeaturesByIDsParameters({
            returnContent: true,
            // datasetNames: ["World:Countries"],//数据集
            datasetNames:["yang:xiaoqu"],    //xiaoqu  school  学校 科研教育__point
            fromIndex: 0,
            toIndex:-1,
            IDs: [1,3,5,6,7,8,10]
        });

        getFeaturesByIDsService = new SuperMap.REST.GetFeaturesByIDsService(url1, {
            eventListeners: {"processCompleted": processCompleted, "processFailed": processFailed}});
        getFeaturesByIDsService.processAsync(getFeaturesByIDsParameters);
    }
    function processCompleted(getFeaturesEventArgs) {

        var i, len, features, feature, result = getFeaturesEventArgs.result;
        if (result && result.features) {
            features = result.features

            for (i=0, len=features.length; i<len; i++) {
                feature = features[i];
                feature.style = style;
                vector.addFeatures(feature);
                console.log(feature.geometry.x+"    "+feature.geometry.y);

            }
        }
    }
    function processFailed(e) {
        alert("失败:"+e.error.errorMsg);
    }
    function clearFeatures() {
//先清除上次的显示结果
        vector.removeAllFeatures();
        vector.refresh();
        console.clear();
    }
</script>
</body>
</html>